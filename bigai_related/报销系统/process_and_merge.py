"""
æ”¹è¿›ç‰ˆå›¾ç‰‡æ–‡å­—æå–è„šæœ¬
1. ä¼˜å…ˆä¸­æ–‡OCRè¯†åˆ«
2. å°†æ‰€æœ‰æå–çš„æ–‡å­—åˆå¹¶åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ä¸­
"""

from image_text_extractor import batch_extract_and_merge

# ğŸ”¥ åœ¨è¿™é‡Œä¿®æ”¹ä¸ºä½ çš„æ–‡ä»¶å¤¹è·¯å¾„ ğŸ”¥
FOLDER_PATH = "/Users/lr-2002/Documents/æŠ¥é”€ææ–™/7.18/å›¾ç‰‡"  # ä¿®æ”¹è¿™é‡Œï¼

def main():
    """å¤„ç†æŒ‡å®šæ–‡ä»¶å¤¹å¹¶åˆå¹¶æ‰€æœ‰æ–‡å­—åˆ°ä¸€ä¸ªæ–‡ä»¶"""
    
    print(f"æ­£åœ¨å¤„ç†æ–‡ä»¶å¤¹: {FOLDER_PATH}")
    print("æ”¹è¿›åŠŸèƒ½:")
    print("âœ… ä¼˜å…ˆä¸­æ–‡OCRè¯†åˆ«")
    print("âœ… åˆå¹¶æ‰€æœ‰æ–‡å­—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶")
    print("=" * 60)
    
    # æ‰¹é‡å¤„ç†å¹¶åˆå¹¶æ‰€æœ‰å›¾ç‰‡çš„æ–‡å­—
    result = batch_extract_and_merge(FOLDER_PATH)
    
    print("=" * 60)
    print("ğŸ‰ å¤„ç†å®Œæˆ!")
    print(f"âœ… æˆåŠŸå¤„ç†: {result['success']} ä¸ªå›¾ç‰‡æ–‡ä»¶")
    print(f"âŒ å¤„ç†å¤±è´¥: {result['failed']} ä¸ªå›¾ç‰‡æ–‡ä»¶") 
    print(f"ğŸ“ æ‰«ææ€»è®¡: {result['total']} ä¸ªå›¾ç‰‡æ–‡ä»¶")
    
    if result['success'] > 0:
        print(f"\nğŸ“ æ‰€æœ‰æå–çš„æ–‡å­—å·²åˆå¹¶ä¿å­˜åˆ°:")
        print(f"ğŸ“‚ {result.get('merged_file', 'åˆå¹¶æ–‡ä»¶')}")
        print(f"\nğŸ’¡ æ–‡ä»¶å†…å®¹åŒ…å«:")
        print(f"   - æ¯ä¸ªå›¾ç‰‡çš„æ–‡å­—å†…å®¹")
        print(f"   - æ¸…æ™°çš„æ–‡ä»¶åˆ†éš”æ ‡è¯†")
        print(f"   - å¤„ç†ç»Ÿè®¡ä¿¡æ¯")
    elif result['total'] == 0:
        print(f"\nâš ï¸  åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶")
        print(f"æ”¯æŒçš„æ ¼å¼: jpg, jpeg, png, bmp, tiff, gif")
    else:
        print(f"\nâŒ æ‰€æœ‰æ–‡ä»¶å¤„ç†å¤±è´¥ï¼Œå¯èƒ½çš„åŸå› :")
        print(f"   - å›¾ç‰‡æ ¼å¼ä¸æ”¯æŒ")
        print(f"   - OCRæ— æ³•è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—")
        print(f"   - å›¾ç‰‡è´¨é‡è¿‡ä½")

if __name__ == "__main__":
    main()
